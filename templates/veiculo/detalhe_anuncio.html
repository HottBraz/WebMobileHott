{% extends 'base.html' %}
{% block title %}{{ anuncio.titulo }} - Hott Motors{% endblock %}

{% block conteudo %}
<div class="min-h-screen bg-black">
    <div class="container mx-auto px-4 py-8">
        <div class="max-w-6xl mx-auto">
            <!-- Breadcrumb -->
            <nav class="mb-6">
                <div class="flex items-center space-x-2 text-gray-400">
                    <a href="{% url 'listar-anuncios' %}" class="hover:text-white">An√∫ncios</a>
                    <span>/</span>
                    <span class="text-white">{{ anuncio.titulo }}</span>
                </div>
            </nav>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <!-- Coluna Principal - Detalhes do An√∫ncio -->
                <div class="lg:col-span-2">
                    <!-- Imagem do Ve√≠culo -->
                    <div class="bg-gray-900 rounded-lg overflow-hidden mb-6">
                        {% if anuncio.veiculo.foto %}
                            <img src="{% url 'foto-veiculo' anuncio.veiculo.get_foto_filename %}" 
                                 alt="{{ anuncio.titulo }}" 
                                 class="w-full h-96 object-cover">
                        {% else %}
                            <div class="w-full h-96 bg-gray-800 flex items-center justify-center">
                                <div class="text-center">
                                    <div class="text-6xl text-gray-600 mb-4">üöó</div>
                                    <p class="text-gray-500">Nenhuma foto dispon√≠vel</p>
                                </div>
                            </div>
                        {% endif %}
                    </div>

                    <!-- T√≠tulo e Informa√ß√µes B√°sicas -->
                    <div class="bg-gray-900 rounded-lg p-6 mb-6">
                        <h1 class="text-3xl font-bold text-white mb-4">{{ anuncio.titulo }}</h1>
                        
                        <!-- Pre√ßo/Tipo -->
                        <div class="mb-4">
                            {% if anuncio.tipo_anuncio == 'venda' %}
                                <div class="text-3xl font-bold text-red-500">R$ {{ anuncio.preco|floatformat:2 }}</div>
                            {% else %}
                                <div class="text-2xl font-bold text-blue-400">DISPON√çVEL PARA TROCA</div>
                            {% endif %}
                        </div>

                        <!-- Informa√ß√µes do Ve√≠culo -->
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                            <div>
                                <h4 class="text-gray-400 text-sm">Marca</h4>
                                <p class="text-white font-semibold">{{ anuncio.veiculo.marca }}</p>
                            </div>
                            <div>
                                <h4 class="text-gray-400 text-sm">Modelo</h4>
                                <p class="text-white font-semibold">{{ anuncio.veiculo.modelo }}</p>
                            </div>
                            <div>
                                <h4 class="text-gray-400 text-sm">Ano</h4>
                                <p class="text-white font-semibold">{{ anuncio.veiculo.ano }}</p>
                            </div>
                            <div>
                                <h4 class="text-gray-400 text-sm">Cor</h4>
                                <p class="text-white font-semibold">{{ anuncio.veiculo.cor }}</p>
                            </div>
                            <div>
                                <h4 class="text-gray-400 text-sm">Combust√≠vel</h4>
                                <p class="text-white font-semibold">{{ anuncio.veiculo.get_combustivel_display }}</p>
                            </div>
                            {% if anuncio.quilometragem %}
                            <div>
                                <h4 class="text-gray-400 text-sm">Quilometragem</h4>
                                <p class="text-white font-semibold">{{ anuncio.quilometragem|floatformat:0 }} km</p>
                            </div>
                            {% endif %}
                            <div>
                                <h4 class="text-gray-400 text-sm">Tipo</h4>
                                <p class="text-white font-semibold">{{ anuncio.get_tipo_anuncio_display }}</p>
                            </div>
                            <div>
                                <h4 class="text-gray-400 text-sm">Status</h4>
                                <span class="inline-block px-2 py-1 text-xs font-semibold rounded-full 
                                    {% if anuncio.status == 'ativo' %}bg-green-600 text-white
                                    {% elif anuncio.status == 'vendido' %}bg-red-600 text-white
                                    {% else %}bg-yellow-600 text-black{% endif %}">
                                    {{ anuncio.get_status_display|upper }}
                                </span>
                            </div>
                        </div>

                        <!-- Descri√ß√£o -->
                        {% if anuncio.descricao %}
                            <div class="border-t border-gray-700 pt-6">
                                <h3 class="text-xl font-semibold text-white mb-3">Descri√ß√£o</h3>
                                <div class="text-gray-300 whitespace-pre-line">{{ anuncio.descricao }}</div>
                            </div>
                        {% endif %}
                    </div>

                    <!-- Informa√ß√µes Adicionais -->
                    <div class="bg-gray-900 rounded-lg p-6">
                        <h3 class="text-xl font-semibold text-white mb-4">Informa√ß√µes do An√∫ncio</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                            <div class="flex items-center text-gray-300">
                                <span class="mr-2">üìÖ</span>
                                Publicado em {{ anuncio.data_criacao|date:"d/m/Y √†s H:i" }}
                            </div>
                            <div class="flex items-center text-gray-300">
                                <span class="mr-2">üëÅÔ∏è</span>
                                {{ anuncio.visualizacoes }} visualiza√ß√µes
                            </div>
                            <div class="flex items-center text-gray-300">
                                <span class="mr-2">üìç</span>
                                {{ anuncio.cidade }}, {{ anuncio.estado }}
                            </div>
                            <div class="flex items-center text-gray-300">
                                <span class="mr-2">üë§</span>
                                {{ anuncio.usuario.first_name|default:anuncio.usuario.username }}
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Sidebar - Contato e A√ß√µes -->
                <div class="lg:col-span-1">
                    <!-- Card de Contato -->
                    <div class="bg-gray-900 rounded-lg p-6 mb-6">
                        <h3 class="text-xl font-semibold text-white mb-4">Entre em Contato</h3>
                        
                        <!-- Telefone -->
                        {% if anuncio.telefone %}
                            <div class="mb-4">
                                <div class="flex items-center text-gray-300 mb-2">
                                    <span class="mr-2">üìû</span>
                                    <span>Telefone</span>
                                </div>
                                <a href="tel:{{ anuncio.telefone }}" 
                                   class="block bg-green-600 hover:bg-green-700 text-white text-center py-3 rounded-lg font-semibold transition-colors">
                                    {{ anuncio.telefone }}
                                </a>
                            </div>
                        {% endif %}

                        <!-- WhatsApp -->
                        {% if anuncio.telefone %}
                            <div class="mb-4">
                                <a href="https://wa.me/55{{ anuncio.telefone|cut:' '|cut:'-'|cut:'('|cut:')'|cut:'+' }}?text=Ol√°! Tenho interesse no seu an√∫ncio: {{ anuncio.titulo }}" 
                                   target="_blank"
                                   class="block bg-green-500 hover:bg-green-600 text-white text-center py-3 rounded-lg font-semibold transition-colors">
                                    üí¨ WhatsApp
                                </a>
                            </div>
                        {% endif %}

                        <!-- Email -->
                        <div class="mb-4">
                            <a href="mailto:{{ anuncio.usuario.email }}?subject=Interesse no an√∫ncio: {{ anuncio.titulo }}&body=Ol√° {{ anuncio.usuario.first_name|default:anuncio.usuario.username }}, tenho interesse no seu an√∫ncio." 
                               class="block bg-blue-600 hover:bg-blue-700 text-white text-center py-3 rounded-lg font-semibold transition-colors">
                                ‚úâÔ∏è Enviar E-mail
                            </a>
                        </div>
                    </div>

                    <!-- A√ß√µes do Propriet√°rio -->
                    {% if user == anuncio.usuario %}
                        <div class="bg-gray-900 rounded-lg p-6 mb-6">
                            <h3 class="text-lg font-semibold text-white mb-4">Gerenciar An√∫ncio</h3>
                            <div class="space-y-3">
                                <a href="{% url 'editar-anuncio' anuncio.pk %}" 
                                   class="block bg-yellow-600 hover:bg-yellow-700 text-white text-center py-2 rounded-lg font-medium transition-colors">
                                    ‚úèÔ∏è Editar
                                </a>
                                
                                {% if anuncio.status == 'ativo' %}
                                    <button onclick="alterarStatus('pausado')" 
                                            class="block w-full bg-orange-600 hover:bg-orange-700 text-white text-center py-2 rounded-lg font-medium transition-colors">
                                        ‚è∏Ô∏è Pausar
                                    </button>
                                {% elif anuncio.status == 'pausado' %}
                                    <button onclick="alterarStatus('ativo')" 
                                            class="block w-full bg-green-600 hover:bg-green-700 text-white text-center py-2 rounded-lg font-medium transition-colors">
                                        ‚ñ∂Ô∏è Reativar
                                    </button>
                                {% endif %}
                                
                                <button onclick="alterarStatus('vendido')" 
                                        class="block w-full bg-blue-600 hover:bg-blue-700 text-white text-center py-2 rounded-lg font-medium transition-colors">
                                    ‚úÖ Marcar como Vendido
                                </button>
                                
                                <button onclick="confirmarExclusao()" 
                                        class="block w-full bg-red-600 hover:bg-red-700 text-white text-center py-2 rounded-lg font-medium transition-colors">
                                    üóëÔ∏è Excluir
                                </button>
                            </div>
                        </div>
                    {% endif %}

                    <!-- Dicas de Seguran√ßa -->
                    <div class="bg-yellow-900 border border-yellow-600 rounded-lg p-4">
                        <h4 class="text-yellow-400 font-semibold mb-2">üîí Dicas de Seguran√ßa</h4>
                        <ul class="text-yellow-200 text-sm space-y-1">
                            <li>‚Ä¢ Sempre veja o ve√≠culo pessoalmente</li>
                            <li>‚Ä¢ Prefira locais p√∫blicos para encontros</li>
                            <li>‚Ä¢ Verifique a documenta√ß√£o</li>
                            <li>‚Ä¢ Desconfie de pre√ßos muito baixos</li>
                            <li>‚Ä¢ N√£o fa√ßa transfer√™ncias antecipadas</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Scripts -->
<script>
function alterarStatus(novoStatus) {
    if (confirm(`Tem certeza que deseja alterar o status para "${novoStatus}"?`)) {
        // Aqui voc√™ implementaria a altera√ß√£o via AJAX
        // Por enquanto, vamos recarregar a p√°gina
        alert('Funcionalidade em desenvolvimento');
    }
}

function confirmarExclusao() {
    if (confirm('Tem certeza que deseja excluir este an√∫ncio? Esta a√ß√£o n√£o pode ser desfeita.')) {
        window.location.href = "{% url 'apagar-anuncio' anuncio.pk %}";
    }
}
</script>
{% endblock %}